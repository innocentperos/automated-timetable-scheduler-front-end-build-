import{u as R}from"./fetch.EGa3nfvI.js";import{n as U,T as v,r as m,W as w,V as L,v as V,q as S,X as T,o as A,y as E,w as t,z as s,A as y,b as e,a as k,d as u,t as N}from"./entry.tQWHpBLf.js";import{u as h}from"./use-fetch-header.3DHnPbz-.js";import{u as g}from"./use-notification.Rdal1ke4.js";import{a as B,V as $}from"./VRow.WlLBb9Jc.js";import{V as F}from"./VDataTable.Jz7QZbN2.js";import{V as H}from"./VSpacer.t62wCS3Z.js";import{V as p}from"./VBtn._oQ1uiNP.js";import{V as P}from"./VSkeletonLoader.bS24LWfm.js";import{V as Y}from"./VDialog.SCbeIy52.js";import{V as q,a as z,b as M,c as O}from"./VCard.T8BHTP73.js";import"./VSelect.4u-stGGs.js";import"./VTextField.6LPIlZmm.js";import"./index.qvKOBlyP.js";import"./transition.31NosCAE.js";import"./VInput.AAxW8xuy.js";import"./index.AmeJTHgO.js";import"./easing.imumzmxr.js";import"./forwardRefs.y8pOSn8h.js";import"./VAvatar.NX62-iRj.js";import"./VList.lljtylUW.js";import"./ssrBoot.0aXw1rzb.js";import"./createSimpleFunctional.413Od-xt.js";import"./VDivider.KeqwIEcH.js";import"./dialog-transition.OyYDh7J5.js";import"./VMenu.CmTKH41A.js";import"./VOverlay.1V9m9YmJ.js";import"./lazy.hsVx4m50.js";import"./VProgressCircular.DTBbBXDU.js";import"./VCheckboxBtn.ztQGvB4X.js";import"./VChip.ttJWPZTa.js";import"./filter.y4xAiLA_.js";const W={class:"d-flex pa-8"},X=k("span",{class:"text-h6 text-uppercase"},"Department Courses",-1),De=U({__name:"course-list-table",props:{departmentPk:{},active:{type:Boolean}},setup(_){const C=[{title:"Title",key:"title",value:"title"},{title:"Code",key:"code",value:"code"},{title:"level",key:"level",value:o=>o.level+"L"},{title:"semester",key:"semester",value:o=>o.semester==1?"First":"Second"},{title:"Students",key:"student_count",value:"student_count"}],c=_,{data:n,pending:b,refresh:x}=R(`/departments/${c.departmentPk}/courses/`,{baseURL:v().public.baseURL,headers:h([]),retry:5,retryDelay:300,default(){return[]}},"$dk8VOuVi1m"),a=m([]);let f=[];w(()=>{f=L().addActions([{title:"Delete",icon:"mdi-delete",color:"error",action(){l.value=!0},hidden:V(()=>S().isAdmin.value?!c.active||a.value.length<1:!0),loading:V(()=>d.value)}])}),T(()=>{f.forEach(g().remove)});const l=m(!1),d=m(!1);async function D(){if(!(a.value.length<1))try{d.value=!0,await $fetch("/courses/multiple_delete/",{baseURL:v().public.baseURL,method:"DELETE",body:a.value,headers:h([])}),n.value=n.value.filter(o=>!a.value.includes(o.pk)),g().add({text:`Successfully deleted ${a.value.length} courses`,icon:"mdi-delete",color:"teal",action:o=>o()}),a.value=[]}catch(o){console.log({error:o})}finally{d.value=!1,l.value=!1}}return(o,r)=>(A(),E($,null,{default:t(()=>[e(B,null,{default:t(()=>[e(F,{headers:C,items:s(n),"show-select":"",modelValue:s(a),"onUpdate:modelValue":r[0]||(r[0]=i=>y(a)?a.value=i:null),"item-value":"pk",loading:s(b)},{top:t(()=>[k("div",W,[X,e(H),e(p,{icon:"mdi-refresh",color:"primary",onClick:s(x)},null,8,["onClick"])])]),loading:t(()=>[e(P,{type:"table-row@6"})]),_:1},8,["items","modelValue","loading"]),e(Y,{modelValue:s(l),"onUpdate:modelValue":r[2]||(r[2]=i=>y(l)?l.value=i:null),"max-width":"500px",transition:"dialog-transition"},{default:t(()=>[e(q,null,{default:t(()=>[e(z,{"primary-title":"",class:"pa-4"},{default:t(()=>[u(" Are you sure? ")]),_:1}),e(M,null,{default:t(()=>[u(" You are about to delete the "+N(s(a).length)+" selected courses ",1)]),_:1}),e(O,{class:"pa-4"},{default:t(()=>[e(p,{onClick:D,color:"error",variant:"elevated"},{default:t(()=>[u(" Yes, delete ")]),_:1}),e(p,{class:"ml-2",onClick:r[1]||(r[1]=i=>l.value=!1)},{default:t(()=>[u("No, Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{De as default};
