import{n as _e,v as f,V as _,W as Ve,X as he,Y as ke,r as u,T as j,o as d,y as C,w as t,b as e,z as o,A as S,c as $,d as r,t as c,D as z,L as ge,Z as Y,Q as q,a as h,a1 as ye,a2 as Ce,$ as te,a0 as ae}from"./entry.tQWHpBLf.js";import{u as Se}from"./fetch.EGa3nfvI.js";import{u as H}from"./use-fetch-header.3DHnPbz-.js";import{u as be}from"./departments-store.L9CsyjDw.js";import{u as b}from"./use-notification.Rdal1ke4.js";import{a as O}from"./index.qvKOBlyP.js";import{a as D,V as W}from"./VRow.WlLBb9Jc.js";import{V as xe}from"./VDataTable.Jz7QZbN2.js";import{V as N}from"./VChip.ttJWPZTa.js";import{V as X}from"./VMenu.CmTKH41A.js";import{V as De}from"./VTextField.6LPIlZmm.js";import{V as Z,a as V}from"./VList.lljtylUW.js";import{V as we}from"./VDivider.KeqwIEcH.js";import{V as I}from"./index.AmeJTHgO.js";import{V as w}from"./VSpacer.t62wCS3Z.js";import{V as B}from"./VBtn._oQ1uiNP.js";import{V as Ee}from"./VAvatar.NX62-iRj.js";import{V as G,b as J,a as Ae,c as Le}from"./VCard.T8BHTP73.js";import{V as Te}from"./VSkeletonLoader.bS24LWfm.js";import{V as K}from"./VBottomSheet.LCPQfWr_.js";import{V as Re}from"./VDialog.SCbeIy52.js";import{V as Ue}from"./VContainer.HgjfEFlY.js";import{V as ee}from"./VCheckboxBtn.ztQGvB4X.js";import"./courses-store.hFHtJJlz.js";import"./use-logger.h09id-NO.js";import"./VSelect.4u-stGGs.js";import"./VInput.AAxW8xuy.js";import"./transition.31NosCAE.js";import"./forwardRefs.y8pOSn8h.js";import"./dialog-transition.OyYDh7J5.js";import"./easing.imumzmxr.js";import"./VProgressCircular.DTBbBXDU.js";import"./VOverlay.1V9m9YmJ.js";import"./lazy.hsVx4m50.js";import"./filter.y4xAiLA_.js";import"./ssrBoot.0aXw1rzb.js";import"./createSimpleFunctional.413Od-xt.js";const $e=te(()=>ae(()=>import("./add-staff-modal.UQa8Txbw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]),import.meta.url).then(p=>p.default||p)),ze=te(()=>ae(()=>import("./update-staff-modal.ivRXOLBA.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,25,21,22,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,20,23,43,44,45,46,47,19,24,48]),import.meta.url).then(p=>p.default||p)),Ne=h("span",{class:"text-h5 text-uppercase"},"Staff",-1),Ie={key:0},Be={class:"d-flex align-center justify-start"},Me={class:"d-flex align-center justify-start"},Pe={class:"d-flex"},bt=_e({__name:"index",setup(p){const E=[],A=f(()=>_().query.value);function le(){_().setQuery("")}Ve(()=>{E.push(_().addAction({title:"New Staff",icon:"mdi-plus",description:"Add a new staff",action(){g.value=!0}})),E.push(_().addAction({title:f(()=>`Delete (${i.value.length})`),hidden:f(()=>i.value.length<1),icon:"mdi-delete",color:"error",action(){v.value=!0}})),_().setTitle("Staffs")}),he(()=>{_().removeActions(E)});const oe=[{title:"Name",key:"name",value:"name"},{title:"Department",key:"department",value:l=>l.department.pk},{title:"Staff Id",key:"staff_id",value:"staff_id"},{title:"Supervises",key:"can_supervise",value:"can_supervise"},{title:"Invigilates",key:"can_invigilate",value:"can_invigilate"},{title:"",key:"actions",value:()=>"true",align:"end"}],se=ke(),ne=f(()=>se.height.value-96),i=u([]),{data:x,pending:re,refresh:ie}=Se("/staffs",{baseURL:j().public.baseURL,headers:H([]),default(){return[]}},"$1BxVqmY9yT"),ue=f(()=>x.value.filter(l=>!(n.value.size>0&&!n.value.has(l.department.pk)))),de=be().all(),M=f(()=>de.value.filter(l=>l.title.toLowerCase().includes(L.value))),n=u(new Set([])),k=u(!1),L=u(""),ce=f(()=>k.value?L.value:n.value.size==0?"Showing all departments":n.value.size+" selected departments");function me(l){L.value=l}function P(l){n.value.has(l.pk)?n.value.delete(l.pk):n.value.add(l.pk)}const g=u(!1);function Q(l){if(g.value=!1,l){x.value.push(l),b().add({title:"New Staff",text:`New staff ${l.name} as added successfully`,icon:"mdi-check-bold",color:"teal",closable:!0,action(s){s()}});return}}const T=u(!1),v=u(!1);async function fe(){try{T.value=!0,await $fetch("/staffs/multiple/",{method:"DELETE",baseURL:j().public.baseURL,headers:H([]),body:i.value}),b().add({title:"Success",text:"The selected staff have be deleted.",icon:"mdi-delete",closable:!0,color:"success",action(l){l()},secondaryActions:[{type:"both",icon:"mdi-undo-variant",text:"undo",action(l){l()}}]}),ie()}catch(l){const s=l;if(!s.statusCode)b().postNetowrkIssue();else switch(s.statusCode){case 400:break;default:b().postServerIssue();break}}finally{T.value=!1,v.value=!1,i.value=[]}}const y=u(!1),R=u();function pe(l){R.value=l,y.value=!0}async function F(l){if(y.value=!1,l){b().add({title:"Success",text:`staff ${l.name} was updated successfully`,icon:"mdi-check-circle",color:"success",closable:!0});const s=x.value.findIndex(U=>U.pk==l.pk);x.value[s]=l}}return(l,s)=>{const U=$e,ve=ze;return d(),C(Ue,{fluid:""},{default:t(()=>[e(W,null,{default:t(()=>[e(D,null,{default:t(()=>[e(xe,{headers:oe,items:o(ue),loading:o(re),"show-select":"",modelValue:o(i),"onUpdate:modelValue":s[2]||(s[2]=a=>S(i)?i.value=a:null),"item-value":"pk",search:o(A),height:o(ne)-180,"fixed-header":""},{top:t(()=>[e(W,{justify:"center",align:"center",class:"pa-8"},{default:t(()=>[e(D,{cols:"4"},{default:t(()=>[Ne]),_:1}),e(D,{cols:"4"},{default:t(()=>[o(A).length>0?(d(),$("div",Ie,[r(" Searching: "),e(N,{closable:"","onClick:close":le},{default:t(()=>[r(c(o(A)),1)]),_:1})])):z("",!0)]),_:1}),e(D,{cols:"4"},{default:t(()=>[e(X,{modelValue:o(k),"onUpdate:modelValue":s[1]||(s[1]=a=>S(k)?k.value=a:null),location:"bottom","close-on-content-click":!1},{activator:t(({props:a})=>[e(De,ge({label:"Departments to show",density:"compact"},a,{onClick:s[0]||(s[0]=m=>k.value=!0),"onUpdate:modelValue":me,"model-value":o(ce),messages:`${o(n).size} departments selected`,"append-inner-icon":"mdi-menu-down"}),null,16,["model-value","messages"])]),default:t(()=>[e(Z,{"max-height":"300"},{default:t(()=>[e(V,{subtitle:"selected"}),e(O,{group:""},{default:t(()=>[(d(!0),$(q,null,Y(o(M).filter(a=>o(n).has(a.pk)),a=>(d(),C(V,{key:a.pk,onClick:m=>P(a)},{title:t(()=>[h("div",Be,[e(ee,{"model-value":o(n).has(a.pk),class:"mr-2",inline:""},null,8,["model-value"]),h("span",null,c(a.title),1),e(w)])]),_:2},1032,["onClick"]))),128))]),_:1}),e(we),e(V,{subtitle:"unselected"}),e(O,{group:""},{default:t(()=>[(d(!0),$(q,null,Y(o(M).filter(a=>!o(n).has(a.pk)),a=>(d(),C(V,{key:a.pk,onClick:m=>P(a)},{title:t(()=>[h("div",Me,[e(ee,{"model-value":o(n).has(a.pk),class:"mr-2",inline:""},null,8,["model-value"]),h("span",null,c(a.title),1),e(w)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),"item.can_supervise":t(({item:a,value:m})=>[e(I,{color:m?"teal":"error"},{default:t(()=>[r(c(a.can_supervise?"mdi-check-all":"mdi-close"),1)]),_:2},1032,["color"])]),"item.can_invigilate":t(({item:a,value:m})=>[e(I,{color:m?"teal":"error"},{default:t(()=>[r(c(a.can_invigilate?"mdi-check-all":"mdi-close"),1)]),_:2},1032,["color"])]),"item.actions":t(({item:a})=>[h("div",Pe,[e(w),e(B,{onClick:m=>pe(a),color:"primary","prepend-icon":"mdi-pencil",density:"compact"},{default:t(()=>[r("Edit")]),_:2},1032,["onClick"])])]),"item.user":t(()=>[e(X,null,{activator:t(({props:a})=>[e(N,ye(Ce(a)),{prepend:t(()=>[e(Ee,{class:"mr-1"},{default:t(()=>[e(I,null,{default:t(()=>[r("mdi-account")]),_:1})]),_:1})]),default:t(()=>[r(" email address ")]),_:2},1040)]),default:t(()=>[e(G,null,{default:t(()=>[e(J,null,{default:t(()=>[e(Z,null,{default:t(()=>[e(V,{"prepend-icon":"mdi-lock",title:"Change Password"}),e(V,{"prepend-icon":"mdi-delete",title:"Remove account",color:"error"})]),_:1})]),_:1})]),_:1})]),_:1})]),"item.department":t(({item:a})=>[e(N,null,{default:t(()=>[r(c(a.department.title)+" ("+c(a.department.code)+") ",1)]),_:2},1024)]),loading:t(()=>[e(Te,{type:"table-row@6"})]),_:1},8,["items","loading","modelValue","search","height"])]),_:1})]),_:1}),e(K,{inset:"",modelValue:o(g),"onUpdate:modelValue":s[3]||(s[3]=a=>S(g)?g.value=a:null)},{default:t(()=>[e(U,{onClose:Q,onAdd:Q})]),_:1},8,["modelValue"]),o(R)?(d(),C(K,{key:0,inset:"",modelValue:o(y),"onUpdate:modelValue":s[4]||(s[4]=a=>S(y)?y.value=a:null)},{default:t(()=>[e(ve,{staff:o(R),onClose:F,onUpdate:F},null,8,["staff"])]),_:1},8,["modelValue"])):z("",!0),e(Re,{modelValue:o(v),"onUpdate:modelValue":s[6]||(s[6]=a=>S(v)?v.value=a:null),location:"top center",persistent:"","max-width":"400"},{default:t(()=>[e(G,null,{default:t(()=>[e(Ae,{class:"headline"},{default:t(()=>[r("Delete "+c(o(i).length)+" Staff",1)]),_:1}),e(J,null,{default:t(()=>[r("Are you sure you want to delete the selected staff")]),_:1}),e(Le,null,{default:t(()=>[e(w),e(B,{color:"primary",flat:"",onClick:s[5]||(s[5]=a=>v.value=!1)},{default:t(()=>[r("Cancel")]),_:1}),o(i).length>0?(d(),C(B,{key:0,size:"large",color:"red",loading:o(T),onClick:fe},{default:t(()=>[r("DELETE")]),_:1},8,["loading"])):z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{bt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./add-staff-modal.UQa8Txbw.js","./entry.tQWHpBLf.js","./entry.JkaK1PbT.css","./fetch.EGa3nfvI.js","./use-fetch-header.3DHnPbz-.js","./use-logger.h09id-NO.js","./use-notification.Rdal1ke4.js","./form-validations.GCMU-Axm.js","./index.qvKOBlyP.js","./VCard.T8BHTP73.js","./VRow.WlLBb9Jc.js","./VRow.Jj_ITn01.css","./createSimpleFunctional.413Od-xt.js","./index.AmeJTHgO.js","./index.RLmRraAs.css","./VAvatar.NX62-iRj.js","./transition.31NosCAE.js","./VAvatar.Y9acgeJC.css","./VCard.3-GUCx0W.css","./VCheckbox.SuWXhtYw.js","./VCheckboxBtn.ztQGvB4X.js","./VInput.AAxW8xuy.js","./VInput.RlDaFj_L.css","./VCheckboxBtn.ENbCW1_T.css","./VCheckbox.Flv8K2j6.css","./VTextField.6LPIlZmm.js","./easing.imumzmxr.js","./forwardRefs.y8pOSn8h.js","./VTextField.TVPDxnpH.css","./VSelect.4u-stGGs.js","./VList.lljtylUW.js","./ssrBoot.0aXw1rzb.js","./VDivider.KeqwIEcH.js","./VDivider.8k_-HhJN.css","./VList.caQDbXay.css","./dialog-transition.OyYDh7J5.js","./VMenu.CmTKH41A.js","./VOverlay.1V9m9YmJ.js","./lazy.hsVx4m50.js","./VOverlay.XsbusQk2.css","./VMenu.d2mYOYiy.css","./VProgressCircular.DTBbBXDU.js","./VProgressCircular.u2v1YYMj.css","./VChip.ttJWPZTa.js","./VBtn._oQ1uiNP.js","./VBtn.Y_2JgC81.css","./VChip.y9TZEtu3.css","./VSelect.VhdMMxMj.css","./VForm.Y4-k9QxA.js","./update-staff-modal.ivRXOLBA.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}