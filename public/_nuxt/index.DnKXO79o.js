import{n as re,V as ne,r as k,q as ie,W as de,v,X as ue,Y as ce,o as m,y as _,w as t,b as e,z as l,d as i,t as E,D as z,a as p,L as I,c as B,Z as P,Q as j,T as me,A as pe,$ as W,a0 as q}from"./entry.tQWHpBLf.js";import{_ as fe}from"./add_venue.vue.fS5TvNHf.js";import{u as F}from"./fetch.EGa3nfvI.js";import{u as b}from"./use-fetch-header.3DHnPbz-.js";import{u as c}from"./use-notification.Rdal1ke4.js";import{u as ve}from"./use-logger.h09id-NO.js";import{V as w}from"./VDialog.SCbeIy52.js";import{V as L,a as $,b as U,c as H}from"./VCard.T8BHTP73.js";import{V as O}from"./VSpacer.t62wCS3Z.js";import{V}from"./VBtn._oQ1uiNP.js";import{a as R,V as Y}from"./VRow.WlLBb9Jc.js";import{V as ge}from"./VTooltip.gJvVvmRp.js";import{V as _e,a as Ve}from"./VList.lljtylUW.js";import{V as he}from"./VProgressCircular.DTBbBXDU.js";import{V as ye}from"./VDataTable.Jz7QZbN2.js";import{V as xe}from"./VSkeletonLoader.bS24LWfm.js";import{V as Ce}from"./VContainer.HgjfEFlY.js";import{V as K}from"./VCheckbox.SuWXhtYw.js";import{V as ke}from"./index.AmeJTHgO.js";import{V as be}from"./VChip.ttJWPZTa.js";import"./form-validations.GCMU-Axm.js";import"./VTextField.6LPIlZmm.js";import"./index.qvKOBlyP.js";import"./transition.31NosCAE.js";import"./VInput.AAxW8xuy.js";import"./easing.imumzmxr.js";import"./forwardRefs.y8pOSn8h.js";import"./VAvatar.NX62-iRj.js";import"./VSelect.4u-stGGs.js";import"./dialog-transition.OyYDh7J5.js";import"./VMenu.CmTKH41A.js";import"./VOverlay.1V9m9YmJ.js";import"./lazy.hsVx4m50.js";import"./VCheckboxBtn.ztQGvB4X.js";import"./VForm.Y4-k9QxA.js";import"./createSimpleFunctional.413Od-xt.js";import"./ssrBoot.0aXw1rzb.js";import"./VDivider.KeqwIEcH.js";import"./filter.y4xAiLA_.js";const we=W(()=>q(()=>import("./add-venue-category.MI76A0Lh.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url).then(f=>f.default||f)),De=W(()=>q(()=>import("./is-authenticated.2_vl-wsG.js"),__vite__mapDeps([28,2,3,24,11,8,9,12,25,26,27,29]),import.meta.url).then(f=>f.default||f)),Ae={class:"d-flex justify-space-between align-center w-100"},Ee=p("span",{class:"text-h6 text-uppercase mr-auto"},"Venues Categories",-1),Le={class:"h-100 overflow"},$e={class:""},Ue={class:""},Re=p("span",{class:"text-h5 text-uppercase"},"Venues",-1),Vt=re({__name:"index",setup(f){const M=[{title:"Title",key:"title",value:"title"},{title:"Code",key:"code",value:"code"},{title:"Capacity",key:"capacity",value:"capacity"},{title:"category",key:"category.pk",value:o=>o.category?o.category.title:""}],h=me(),{addAction:T,removeActions:Q}=ne(),r=k({venues:[],categories:[]}),u=k({model:!1,pending:!1}),d=k({model:!1,category:!1}),D=[],S=ie();de(()=>{D.push(T({title:"New Venue",description:"Add a new venue to the list of venues",icon:"mdi-plus",color:"primary",hidden:v(()=>!S.isAdmin.value),action(){d.value.model=!0}})),D.push(T({title:"delete",description:v(()=>`delete the ${r.value.venues.length} selected venues`),icon:"mdi-delete",color:"error",hidden:v(()=>r.value.venues.length<1),loading:v(()=>u.value.model),action(){u.value.model=!0}}))}),ue(()=>{Q(D)});const X=v(()=>r.value.categories.length==0?g.value:g.value.filter(o=>o.category?r.value.categories.includes(o.category.pk):!1)),{data:g,pending:Z}=F("/venues/",{baseURL:h.public.baseURL,headers:b([]),default(){return[]}},"$9rSKhKfgNg"),{data:y,pending:G,refresh:N}=F("/venues/categories/",{baseURL:h.public.baseURL,headers:b([]),default(){return[]}},"$mmikHaYeAy");function J(o){g.value.push(o),d.value.model=!1,N(),c().add({title:"Venue added",text:`${o.title} was added to venues`,icon:"mdi-plus",color:"teal",duration:1e4,action(a){a()}})}function ee(o){y.value.push(o),c().add({title:"Venue Category added",text:`${o.title} was added to venue categories`,icon:"mdi-plus",color:"teal",action(a){a()}})}const x=k(!1);async function te(o){try{await $fetch("/venues/categories/",{baseURL:h.public.baseURL,method:"DELETE",headers:b([]),body:[o.pk],params:{"with-venues":x.value}}),c().add({title:"Category Deleted",text:`${o.title} was deleted Successfully`,closable:!0}),y.value=y.value.filter(a=>a.pk!=o.pk)}catch(a){ve().error("Deleting Category","Error deleting venue category",a);const C=a;if(!C.statusCode){c().postNetowrkIssue();return}switch(C.statusCode){case 401:c().add({title:"Error deleting category",text:"Only admin user can delete venues and venues categories",closable:!0,color:"error",icon:"mdi-alert-circle"});break;case 500:c().postServerIssue();break;default:c().add({title:"Error deleting category",text:`An error occured will attempting to delete ${o.title} category`,closable:!0,color:"error",icon:"mdi-alert-circle"})}}}async function ae(){if(!(r.value.venues.length<1))try{u.value.pending=!0,await $fetch("/venues/multiple_delete/",{baseURL:h.public.baseURL,method:"DELETE",body:r.value.venues,headers:b([])}),g.value=g.value.filter(o=>!r.value.venues.includes(o.pk)),N(),c().add({text:`Successfully deleted ${r.value.venues.length} venues`,icon:"mdi-delete",color:"teal",action:o=>o()}),r.value.venues=[]}catch(o){console.log({error:o})}finally{u.value={pending:!1,model:!1}}}const le=ce(),A=v(()=>le.height.value-96);return(o,a)=>{const C=fe,oe=we,se=De;return m(),_(Ce,{fluid:""},{default:t(()=>[e(w,{draggable:"",modelValue:l(d).model,"onUpdate:modelValue":a[1]||(a[1]=s=>l(d).model=s),persistent:"","max-width":"500"},{default:t(()=>[e(C,{onAdd:J,onClose:a[0]||(a[0]=s=>l(d).model=!1)})]),_:1},8,["modelValue"]),e(w,{modelValue:l(u).model,"onUpdate:modelValue":a[3]||(a[3]=s=>l(u).model=s),location:"top center",persistent:"","max-width":"400"},{default:t(()=>[e(L,null,{default:t(()=>[e($,{class:"headline"},{default:t(()=>[i("Delete "+E(l(r).venues.length)+" Venues",1)]),_:1}),e(U,null,{default:t(()=>[i("Are you sure you want to delete the selected venues")]),_:1}),e(H,null,{default:t(()=>[e(O),e(V,{color:"primary",flat:"",onClick:a[2]||(a[2]=s=>l(u).model=!1)},{default:t(()=>[i("Cancel")]),_:1}),l(r).venues.length>0?(m(),_(V,{key:0,size:"large",color:"red",loading:l(u).pending,onClick:ae},{default:t(()=>[i("DELETE")]),_:1},8,["loading"])):z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:l(d).category,"onUpdate:modelValue":a[5]||(a[5]=s=>l(d).category=s),location:"top center",persistent:"","max-width":"400"},{default:t(()=>[e(oe,{onClose:a[4]||(a[4]=s=>l(d).category=!1),onAdd:ee})]),_:1},8,["modelValue"]),e(Y,null,{default:t(()=>[e(R,{cols:"12",lg:"3"},{default:t(()=>[e(L,{class:"py-4",color:"teal",density:"compact","max-height":l(A)},{default:t(()=>[e($,null,{default:t(()=>[p("div",Ae,[Ee,e(se,{"user-type":"admin"},{default:t(()=>[e(ge,{text:"Create a new venue category",right:""},{activator:t(({props:s})=>[e(V,I({icon:"mdi-plus",variant:"text",color:"white"},s,{onClick:a[6]||(a[6]=n=>l(d).category=!0)}),null,16)]),_:1})]),_:1})])]),_:1}),e(U,{class:"px-0"},{default:t(()=>[p("div",Le,[e(_e,{class:"w-100 transparent mx-0 px-0","max-height":l(A)-100,"bg-color":"transparent"},{default:t(()=>[(m(!0),B(j,null,P(l(y),s=>(m(),_(Ve,{key:s.pk,value:s.pk,color:"trn",class:"transparent",nav:"",title:s.title,subtitle:`${s.venue_count} Venues`},{prepend:t(()=>[e(w,{overlay:!1,"max-width":"600px",transition:"dialog-transition"},{activator:t(({props:n})=>[e(V,I({icon:"mdi-delete",size:"small",variant:"text",class:"mr-2"},n),null,16)]),default:t(()=>[e(L,null,{default:t(()=>[e($,{"primary-title":""},{default:t(()=>[i(" Are you sure? ")]),_:1}),e(U,null,{default:t(()=>[i(" Delete the category "+E(s.title)+" ",1),p("div",$e,[e(K,{class:"w-100",label:"Delete all venues under category","hide-details":"",modelValue:l(x),"onUpdate:modelValue":a[7]||(a[7]=n=>pe(x)?x.value=n:null)},null,8,["modelValue"])])]),_:2},1024),e(H,{class:"px-4 d-flex justify-space-between"},{default:t(()=>[e(V,{onClick:n=>te(s),color:"error",variant:"elevated"},{default:t(()=>[i(" Yes Delete ")]),_:2},1032,["onClick"]),p("span",null,[e(ke,null,{default:t(()=>[i("mdi-information")]),_:1}),i(" click outside to close")])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),append:t(()=>[e(K,{"hide-details":"",indeterminate:"",color:"white",modelValue:l(r).categories,"onUpdate:modelValue":a[8]||(a[8]=n=>l(r).categories=n),value:s.pk},null,8,["modelValue","value"])]),_:2},1032,["value","title","subtitle"]))),128))]),_:1},8,["max-height"])]),p("div",Ue,[l(G)?(m(),_(he,{key:0,value:20,indeterminate:"",color:"primary",class:"my-auto"})):z("",!0)])]),_:1})]),_:1},8,["max-height"])]),_:1}),e(R,{cols:"12",lg:"9"},{default:t(()=>[e(ye,{headers:M,items:l(X),loading:l(Z),"show-select":l(S).isAdmin.value,modelValue:l(r).venues,"onUpdate:modelValue":a[9]||(a[9]=s=>l(r).venues=s),"item-value":"pk",height:l(A)-120,"fixed-header":""},{top:t(()=>[e(Y,{justify:"center",class:"pa-4"},{default:t(()=>[e(R,null,{default:t(()=>[Re]),_:1}),e(O)]),_:1})]),"item.departments":t(({value:s})=>[(m(!0),B(j,null,P(s,n=>(m(),_(be,{key:n.pk,class:"ml-1",color:"teal"},{default:t(()=>[i(E(n.code),1)]),_:2},1024))),128))]),loading:t(()=>[e(xe,{type:"table-row@6"})]),_:1},8,["items","loading","show-select","modelValue","height"])]),_:1})]),_:1})]),_:1})}}});export{Vt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./add-venue-category.MI76A0Lh.js","./form-validations.GCMU-Axm.js","./entry.tQWHpBLf.js","./entry.JkaK1PbT.css","./use-notification.Rdal1ke4.js","./use-fetch-header.3DHnPbz-.js","./use-logger.h09id-NO.js","./VCard.T8BHTP73.js","./VRow.WlLBb9Jc.js","./VRow.Jj_ITn01.css","./createSimpleFunctional.413Od-xt.js","./index.AmeJTHgO.js","./index.RLmRraAs.css","./VAvatar.NX62-iRj.js","./transition.31NosCAE.js","./VAvatar.Y9acgeJC.css","./VCard.3-GUCx0W.css","./VTextField.6LPIlZmm.js","./index.qvKOBlyP.js","./VInput.AAxW8xuy.js","./VInput.RlDaFj_L.css","./easing.imumzmxr.js","./forwardRefs.y8pOSn8h.js","./VTextField.TVPDxnpH.css","./VBtn._oQ1uiNP.js","./VProgressCircular.DTBbBXDU.js","./VProgressCircular.u2v1YYMj.css","./VBtn.Y_2JgC81.css","./is-authenticated.2_vl-wsG.js","./is-authenticated.MRbMt392.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}