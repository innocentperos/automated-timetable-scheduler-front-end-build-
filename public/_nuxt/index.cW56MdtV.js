import{n as pe,r as f,V as j,q as b,W as fe,v as d,X as ve,Y as _e,o as c,y as L,w as t,b as o,d as i,t as v,z as a,D as R,A as $,a as _,c as T,Z as Ve,Q as ye,B as he,L as ge,T as Ce,$ as ke,x as we,a0 as xe}from"./entry.tQWHpBLf.js";import{_ as be}from"./add_course.vue.mMU39b5L.js";import Le from"./is-authenticated.2_vl-wsG.js";import{_ as Ee}from"./nuxt-link.tq0YTiuG.js";import{u as B}from"./use-notification.Rdal1ke4.js";import{u as q}from"./fetch.EGa3nfvI.js";import{u as N}from"./use-fetch-header.3DHnPbz-.js";import{V as Se,a as Ae,b as De,c as Ue}from"./VCard.T8BHTP73.js";import{V as I}from"./VSpacer.t62wCS3Z.js";import{V as g,c as Re}from"./VBtn._oQ1uiNP.js";import{V as P}from"./VDialog.SCbeIy52.js";import{a as E,V as O}from"./VRow.WlLBb9Jc.js";import{V as $e}from"./VDataTable.Jz7QZbN2.js";import{V as Q}from"./VChip.ttJWPZTa.js";import{V as Z}from"./VContainer.HgjfEFlY.js";import{V as Te}from"./VTooltip.gJvVvmRp.js";import{V as Be}from"./VSkeletonLoader.bS24LWfm.js";import{V as Ne}from"./VBottomSheet.LCPQfWr_.js";import{R as Fe}from"./index.AmeJTHgO.js";import"./use-logger.h09id-NO.js";import"./form-validations.GCMU-Axm.js";import"./types.H3O6Ekup.js";import"./VBanner.T3kYHC40.js";import"./createSimpleFunctional.413Od-xt.js";import"./VAvatar.NX62-iRj.js";import"./transition.31NosCAE.js";import"./VTextField.6LPIlZmm.js";import"./index.qvKOBlyP.js";import"./VInput.AAxW8xuy.js";import"./easing.imumzmxr.js";import"./forwardRefs.y8pOSn8h.js";import"./VSelect.4u-stGGs.js";import"./VList.lljtylUW.js";import"./ssrBoot.0aXw1rzb.js";import"./VDivider.KeqwIEcH.js";import"./dialog-transition.OyYDh7J5.js";import"./VMenu.CmTKH41A.js";import"./VOverlay.1V9m9YmJ.js";import"./lazy.hsVx4m50.js";import"./VProgressCircular.DTBbBXDU.js";import"./VCheckboxBtn.ztQGvB4X.js";import"./VForm.Y4-k9QxA.js";import"./filter.y4xAiLA_.js";const He=ke(()=>xe(()=>import("./edit_course.heLuKizJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]),import.meta.url).then(S=>S.default||S)),Me={class:"text-h5"},ze=["colspan"],je=_("div",{class:"pa-1"},"Department offering course:",-1),qe=_("br",null,null,-1),Ie={class:"d-flex justify-space-between align-center cursor-pointer text-primary"},Pe={class:""},Bt=pe({__name:"index",setup(S){var z;const J=[{title:"Title",key:"title",value:"title"},{title:"Code",key:"code",value:"code"},{title:"Students",key:"student_count",value:"student_count"},{title:"Department",key:"department.code",value:"department.code"},{title:"Level",key:"level",value:e=>e.level+"L"},{title:"Semester",key:"semester",value:e=>e.semester==1?"First":"Second"}],W=[{title:"Title",key:"title",value:"title"},{title:"Code",key:"code",value:"code"},{title:"Department",key:"department.code",value:"department.code"},{title:"Level",key:"level",value:e=>e.level+"L"},{title:"Semester",key:"semester",value:e=>e.semester==1?"First":"Second"}],u=f({model:!1,pending:!1}),C=f({model:!1}),n=f([]),A=Ce(),{add:X}=B(),{addAction:F,removeActions:Y}=j(),V=b(),D=[];fe(()=>{D.push(F({title:"New Course",icon:"mdi-plus",description:"Add a new course",hidden:d(()=>!V.isAdmin.value),action(){C.value.model=!0}})),D.push(F({title:"delete",description:d(()=>`delete the ${n.value.length} selected courses`),icon:"mdi-delete",color:"error",hidden:d(()=>n.value.length<1),action(){u.value.model=!0}}))}),ve(()=>{Y(D)});const y=f(b().isAdmin.value?"all":"my"),{data:m,pending:G}=q("/courses/",{baseURL:A.public.baseURL,headers:N([]),default(){return[]}},"$jMqHv1ZB8E"),{data:K,pending:ee}=q(`/departments/${(z=V.currentUser.value)==null?void 0:z.department}/courses/`,{baseURL:A.public.baseURL,headers:N([]),default(){return[]},transform:e=>{const l=b().currentUser;return b().isStudent.value?e.filter(r=>{var x;return r.level==((x=l.value)==null?void 0:x.level)}):e}},"$oLJteHh352"),te=d(()=>y.value=="my"?K.value:m.value),{query:k,setQuery:oe}=j(),le=d(()=>te.value.filter(e=>e.title.toLowerCase().includes(k.value.toLowerCase())||e.code.toLowerCase().includes(k.value.toLowerCase()))),ae=d(()=>ee.value||G.value);function se(e){m.value.push(e),X({text:`${e.title} was added Successfully`,icon:"mdi-plus",closable:!0,color:"teal",action(l){l()}})}async function ne(){if(!(n.value.length<1))try{u.value.pending=!0,await $fetch("/courses/multiple_delete/",{baseURL:A.public.baseURL,method:"DELETE",body:n.value,headers:N([])}),m.value=m.value.filter(e=>!n.value.includes(e.pk)),B().add({text:`Successfully deleted ${n.value.length} courses`,icon:"mdi-delete",color:"teal",action:e=>e()}),n.value=[]}catch(e){console.log({error:e})}finally{u.value.pending=!1,u.value.model=!1}}const H=_e(),re=d(()=>H.height.value-240),ie=d(()=>H.mobile.value?W:J);function ue(e){we().push({name:"courses-course_pk",params:{course_pk:e.pk}})}const h=f(!1),w=f();function de(e){h.value=!0,w.value=e}function M(e=void 0){if(h.value=!1,w.value=void 0,e){const l=m.value.findIndex(r=>r.pk==e.pk);B().add({title:"Updated",text:`${e.title} was updated Successfully.`,icon:"mdi-check-circle",color:"success",closable:!0,action(r){r()},secondaryActions:[{type:"both",text:"View",icon:"mdi-launch",color:"success",tooltip:"View course",action(r){r(),ue(e)}}]}),l>-1&&(m.value[l]=e)}}return(e,l)=>{const r=be,x=Le,ce=Ee,me=He;return c(),L(Z,{fluid:""},{default:t(()=>[o(P,{modelValue:a(u).model,"onUpdate:modelValue":l[1]||(l[1]=s=>a(u).model=s),location:"top center",persistent:"","max-width":"400"},{default:t(()=>[o(Se,null,{default:t(()=>[o(Ae,{class:"headline"},{default:t(()=>[i("Delete "+v(a(n).length)+" Courses",1)]),_:1}),o(De,null,{default:t(()=>[i("Are you sure you want to delete the selected courses")]),_:1}),o(Ue,null,{default:t(()=>[o(I),o(g,{color:"primary",flat:"",onClick:l[0]||(l[0]=s=>a(u).model=!1)},{default:t(()=>[i("Cancel")]),_:1}),a(n).length>0?(c(),L(g,{key:0,size:"large",color:"red",loading:a(u).pending,onClick:ne},{default:t(()=>[i("DELETE")]),_:1},8,["loading"])):R("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(P,{modelValue:a(C).model,"onUpdate:modelValue":l[3]||(l[3]=s=>a(C).model=s),location:"top center",persistent:"","max-width":"600"},{default:t(()=>[o(r,{onAdd:se,onClose:l[2]||(l[2]=s=>a(C).model=!1)})]),_:1},8,["modelValue"]),o(O,{"no-gutters":""},{default:t(()=>[o(E,null,{default:t(()=>[o($e,{headers:a(ie),items:a(le),loading:a(ae),"show-select":a(V).isAdmin.value,modelValue:a(n),"onUpdate:modelValue":l[6]||(l[6]=s=>$(n)?n.value=s:null),"item-value":"pk","show-expand":a(V).isAdmin.value||a(V).isStaff.value,"show-current-page":"",sticky:"","items-per-page":50,"fixed-header":"",height:a(re),"header-color":"success"},{top:t(()=>[o(O,{justify:"center","align-content":"center",align:"center",class:"pa-4"},{default:t(()=>[o(E,null,{default:t(()=>[_("span",Me,v(a(y)=="all"?"All Courses":"My Courses"),1)]),_:1}),o(E,null,{default:t(()=>[a(k)?(c(),L(Q,{key:0,closable:"","onClick:close":l[4]||(l[4]=s=>a(oe)(""))},{default:t(()=>[i("Filtered by: "+v(a(k)),1)]),_:1})):R("",!0)]),_:1}),o(I),o(x,{"user-type":["staff","student"]},{default:t(()=>[o(E,{cols:"auto"},{default:t(()=>[o(Re,{color:"teal",modelValue:a(y),"onUpdate:modelValue":l[5]||(l[5]=s=>$(y)?y.value=s:null)},{default:t(()=>[o(g,{value:"all"},{default:t(()=>[i("All Courses")]),_:1}),o(g,{value:"my"},{default:t(()=>[i("My Courses")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"expanded-row":t(({columns:s,item:U})=>[_("tr",null,[_("td",{colspan:s.length},[o(Z,{class:"d-flex flex-wrap"},{default:t(()=>[je,qe,(c(!0),T(ye,null,Ve(U.departments,p=>(c(),T("div",{class:"pa-1",key:p.pk},[o(ce,{to:"/departments/"+p.pk},{default:t(()=>[o(Q,{color:"teal",link:""},{default:t(()=>[i(v(p.title)+" ("+v(p.code)+") ",1)]),_:2},1024)]),_:2},1032,["to"])]))),128))]),_:2},1024)],8,ze)])]),"item.title":t(({value:s,item:U})=>[o(Te,{text:"edit course"},{activator:t(({props:p})=>[he((c(),T("div",Ie,[_("span",Pe,v(s),1),o(g,ge({onClick:Oe=>de(U),color:"primary"},p,{size:"small","append-icon":"mdi-pencil"}),{default:t(()=>[i("edit")]),_:2},1040,["onClick"])])),[[Fe]])]),_:2},1024)]),loading:t(()=>[o(Be,{type:"table-row@20"})]),_:1},8,["headers","items","loading","show-select","modelValue","show-expand","height"])]),_:1})]),_:1}),o(Ne,{inset:"",modelValue:a(h),"onUpdate:modelValue":l[8]||(l[8]=s=>$(h)?h.value=s:null)},{default:t(()=>[a(w)?(c(),L(me,{key:0,course:a(w),"department-id":void 0,onClose:l[7]||(l[7]=s=>M()),onUpdated:M},null,8,["course"])):R("",!0)]),_:1},8,["modelValue"])]),_:1})}}});export{Bt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./edit_course.heLuKizJ.js","./entry.tQWHpBLf.js","./entry.JkaK1PbT.css","./fetch.EGa3nfvI.js","./use-fetch-header.3DHnPbz-.js","./use-logger.h09id-NO.js","./form-validations.GCMU-Axm.js","./types.H3O6Ekup.js","./VCard.T8BHTP73.js","./VRow.WlLBb9Jc.js","./VRow.Jj_ITn01.css","./createSimpleFunctional.413Od-xt.js","./index.AmeJTHgO.js","./index.RLmRraAs.css","./VAvatar.NX62-iRj.js","./transition.31NosCAE.js","./VAvatar.Y9acgeJC.css","./VCard.3-GUCx0W.css","./VBanner.T3kYHC40.js","./VBanner.c-Lj57La.css","./VBtn._oQ1uiNP.js","./VProgressCircular.DTBbBXDU.js","./VProgressCircular.u2v1YYMj.css","./VBtn.Y_2JgC81.css","./VTextField.6LPIlZmm.js","./index.qvKOBlyP.js","./VInput.AAxW8xuy.js","./VInput.RlDaFj_L.css","./easing.imumzmxr.js","./forwardRefs.y8pOSn8h.js","./VTextField.TVPDxnpH.css","./VSelect.4u-stGGs.js","./VList.lljtylUW.js","./ssrBoot.0aXw1rzb.js","./VDivider.KeqwIEcH.js","./VDivider.8k_-HhJN.css","./VList.caQDbXay.css","./dialog-transition.OyYDh7J5.js","./VMenu.CmTKH41A.js","./VOverlay.1V9m9YmJ.js","./lazy.hsVx4m50.js","./VOverlay.XsbusQk2.css","./VMenu.d2mYOYiy.css","./VCheckboxBtn.ztQGvB4X.js","./VCheckboxBtn.ENbCW1_T.css","./VChip.ttJWPZTa.js","./VChip.y9TZEtu3.css","./VSelect.VhdMMxMj.css","./VForm.Y4-k9QxA.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}