import{n as de,r as f,q as me,o as u,y as d,w as t,z as a,d as s,t as pe,a as i,b as e,Q as ce,Z as fe,c as _e,D as N,$ as ve,a0 as he,T}from"./entry.tQWHpBLf.js";import be from"./is-authenticated.2_vl-wsG.js";import{u as ge}from"./departments-store.L9CsyjDw.js";import{u as U}from"./view.TfeFt1aZ.js";import{u as A}from"./use-fetch-header.3DHnPbz-.js";import{u as m}from"./use-notification.Rdal1ke4.js";import{u as Ve}from"./complain-store.LCm3VWOX.js";import{L as ye}from"./types.H3O6Ekup.js";import{V as _,a as r}from"./VList.lljtylUW.js";import{V as b}from"./VBtn._oQ1uiNP.js";import{V as g}from"./index.AmeJTHgO.js";import{V as E}from"./VDivider.KeqwIEcH.js";import{V as ke}from"./VExpansionPanels.Cp-9pIPO.js";import{V,a as y,b as k}from"./VExpansionPanel.ju_wnrv-.js";import{V as x}from"./VAutocomplete.6WsM3riW.js";import{V as j,b as z}from"./VCard.T8BHTP73.js";import{V as B}from"./VCheckbox.SuWXhtYw.js";import{V as F}from"./VAlert.9L9TAqJu.js";import{V as xe}from"./VSkeletonLoader.bS24LWfm.js";import{V as Ce}from"./VProgressCircular.DTBbBXDU.js";import{V as we}from"./VNavigationDrawer.Qf0a9uN4.js";import"./courses-store.hFHtJJlz.js";import"./use-logger.h09id-NO.js";import"./fetch.EGa3nfvI.js";import"./index.qvKOBlyP.js";import"./VRow.WlLBb9Jc.js";import"./VContainer.HgjfEFlY.js";import"./ssrBoot.0aXw1rzb.js";import"./transition.31NosCAE.js";import"./createSimpleFunctional.413Od-xt.js";import"./VAvatar.NX62-iRj.js";import"./lazy.hsVx4m50.js";import"./VSelect.4u-stGGs.js";import"./VTextField.6LPIlZmm.js";import"./VInput.AAxW8xuy.js";import"./easing.imumzmxr.js";import"./forwardRefs.y8pOSn8h.js";import"./dialog-transition.OyYDh7J5.js";import"./VMenu.CmTKH41A.js";import"./VOverlay.1V9m9YmJ.js";import"./VCheckboxBtn.ztQGvB4X.js";import"./VChip.ttJWPZTa.js";import"./filter.y4xAiLA_.js";import"./layout.RwfjoJ97.js";const Ie=ve(()=>he(()=>import("./complain-item.rDgyO9A6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url).then(v=>v.default||v)),Se={class:"d-flex align-center justify-space-between"},Le={class:"pl-2"},Te={class:"d-flex flex-column"},Ue={class:"d-flex align-center text-subtitle-1"},Ae=i("span",null,"Assign Venues ",-1),Ee=i("span",null," This will try to auto assign venues to all courses that do not have venue(s) assigned to them ",-1),De={class:"d-flex align-center text-subtitle-1"},$e=i("span",null,"Auto Assign Invigilators ",-1),Pe=i("span",null," This will try to auto assign invigilator to all venues of the courses that have venue(s) assigned to them ",-1),St=de({__name:"navigation_bar",props:{timetable:{}},setup(v){const p=v,D=ge(),O=D.all(),{selectedDepartments:M,setDepartments:$,selectedLevels:q,setLevels:P,selectedVenues:H,setVenues:Q,selectedStaffs:Z,setStaffs:G}=U(),{data:J,pending:K,refresh:W}=U().getTimetableVenues(p.timetable.pk),{data:X,pending:Y,refresh:ee}=U().getTimetableStaffs(p.timetable.pk);function te(o){$(o)}function ae(o){P(o)}const c=f(!1),le=f(),C=f(!1);async function oe(){C.value=!0;try{await $fetch(`/timetables/${p.timetable.pk}/auto_assign_invigilators/`,{baseURL:T().public.baseURL,headers:A([]),method:"POST"})}catch(o){const l=o;if(!l.statusCode)m().postNetowrkIssue();else switch(l.statusCode){case 404:m().add({title:"Invalid timetable",text:"This timetable does not seem to exist on the system database",icon:"mdi-close-circle",closable:!0,action(n){n()}});break;default:m().postServerIssue();break}}finally{C.value=!1}}const w=f(!1);async function se(){try{w.value=!0,await $fetch(`/timetables/${p.timetable.pk}/auto_assign_venues/`,{baseURL:T().public.baseURL,headers:A([]),method:"POST"})}catch(o){const l=o;if(!l.statusCode)m().postNetowrkIssue();else switch(l.statusCode){case 404:m().add({title:"Invalid timetable",text:"This timetable does not seem to exist on the system database",icon:"mdi-close-circle",closable:!0,action(n){n()}});break;default:m().postServerIssue();break}}finally{w.value=!1}}const{data:R,pending:ne,refresh:Re}=Ve().loadTable(p.timetable.pk),I=me();function ie(){const o=I.currentUser;I.isAuthenticated.value&&o.value&&I.isStudent.value&&(P([o.value.level]),$([o.value.department]))}const S=f(!1);async function re(o){try{S.value=!0;const n=await(await fetch(`${T().public.baseURL}/timetables/${p.timetable.pk}/export/`,{headers:A([])})).blob(),L=window.URL.createObjectURL(n);window.open(L,"Download")}catch(l){console.error(l),m().add({title:"Export failed",text:"An error occured while exporting the timetable",icon:"mdi-close-circle",closable:!0,color:"error",action(n){n()}})}finally{S.value=!1}}return(o,l)=>{const n=be,L=Ie;return u(),d(we,{rail:a(c),"expand-on-hover":"",fixed:"",permanent:"",location:"right",width:"450"},{default:t(()=>[e(_,null,{default:t(()=>[e(r,null,{default:t(()=>[i("div",Se,[e(b,{onClick:l[0]||(l[0]=h=>c.value=!a(c))},{default:t(()=>[a(c)?(u(),d(g,{key:0},{default:t(()=>[s("mdi-eye-off")]),_:1})):(u(),d(g,{key:1},{default:t(()=>[s("mdi-pin-off")]),_:1})),i("span",Le,pe(a(c)?"pin":"Unpin"),1)]),_:1})])]),_:1})]),_:1}),e(E),e(ke,{variant:"accordion"},{default:t(()=>[e(V,null,{default:t(()=>[e(y,null,{default:t(()=>[e(r,{"prepend-icon":"mdi-filter"},{default:t(()=>[s(" Filtering ")]),_:1})]),_:1}),e(k,null,{default:t(()=>[e(_,null,{default:t(()=>[e(r,null,{default:t(()=>[i("div",Te,[e(n,{"user-type":["student"]},{default:t(()=>[e(b,{block:"",color:"primary",class:"mb-4",onClick:ie},{default:t(()=>[s("My Courses")]),_:1})]),_:1}),e(x,{label:"Levels courses to show",items:a(ye),"item-value":"value","item-text":"title","item-key":"value",color:"primary",multiple:"",autocomplete:"",chips:"","model-value":a(q),"onUpdate:modelValue":ae,"prepend-inner-icon":"mdi-account-school-outline"},null,8,["items","model-value"]),e(x,{label:"Department courses to show",items:a(O),"item-value":"pk","item-text":"title","item-key":"pk",multiple:"",autocomplete:"","model-value":a(M),"onUpdate:modelValue":te,"append-inner-icon":"mdi-refresh","onClick:appendInner":a(D).refreshDepartments,"prepend-inner-icon":"mdi-school",chips:""},null,8,["items","model-value","onClick:appendInner"]),e(n,{"user-type":"admin"},{default:t(()=>[e(x,{label:"Staff",items:a(X),"item-value":"pk","item-text":"name","item-title":"name","item-key":"pk",multiple:"",autocomplete:"","model-value":a(Z),"onUpdate:modelValue":a(G),loading:a(Y),"append-inner-icon":"mdi-refresh","onClick:appendInner":a(ee),"prepend-inner-icon":"mdi-account-group",chips:""},null,8,["items","model-value","onUpdate:modelValue","loading","onClick:appendInner"])]),_:1}),e(x,{label:"Venues",items:[{title:"All Venues",pk:0},...a(J)],"item-value":"pk","item-text":"title","item-key":"pk",multiple:"",autocomplete:"","model-value":a(H),"onUpdate:modelValue":a(Q),loading:a(K),"prepend-inner-icon":"mdi-city","append-inner-icon":"mdi-refresh","onClick:appendInner":l[1]||(l[1]=h=>a(W)(o.timetable.pk)),chips:""},null,8,["items","model-value","onUpdate:modelValue","loading"])])]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{"user-type":"admin"},{default:t(()=>[e(V,null,{default:t(()=>[e(y,null,{default:t(()=>[e(r,{"prepend-icon":"mdi-refresh-auto"},{default:t(()=>[s(" Automation ")]),_:1})]),_:1}),e(k,null,{default:t(()=>[e(_,null,{default:t(()=>[e(j,{color:"teal",class:"my-3"},{default:t(()=>[e(z,null,{default:t(()=>[i("div",Ue,[e(g,{class:"mr-3"},{default:t(()=>[s("mdi-home-city-outline")]),_:1}),Ae]),i("div",null,[Ee,e(B,{label:"Inforce adjacent slot optimization","hide-details":""}),e(F,{type:"info",color:"transparent"},{default:t(()=>[s(" This option issues that one venue is not been used in adjacent day slots ")]),_:1}),e(b,{block:"",class:"my-2",color:"primary",onClick:se,loading:a(w)},{default:t(()=>[s("Assign Venues")]),_:1},8,["loading"])])]),_:1})]),_:1}),e(E),e(j,{ref:a(le),color:"teal",class:"my-3 relative",border:""},{default:t(()=>[e(z,null,{default:t(()=>[i("div",De,[e(g,{class:"mr-3"},{default:t(()=>[s("mdi-account-group")]),_:1}),$e]),i("div",null,[Pe,e(B,{label:"Inforce adjacent slot optimization","hide-details":""}),e(F,{type:"info",color:"transparent"},{default:t(()=>[s(" This option insures that a staff does not invigilator two adjacent venue in thesame day ")]),_:1}),e(b,{block:"",class:"my-2",color:"primary",onClick:oe,loading:a(C)},{default:t(()=>[s("Assign Invigilators")]),_:1},8,["loading"])])]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(y,null,{default:t(()=>[e(r,{"prepend-icon":"mdi-forum"},{default:t(()=>[s(" Issues and Complains ")]),_:1})]),_:1}),e(k,{class:"pa-0 ma-0"},{default:t(()=>[a(ne)?(u(),d(xe,{key:0,type:"list-item-two-line@4"})):a(R).length>0?(u(),d(_,{key:1,class:"ma-0 pa-0"},{default:t(()=>[e(r,null,{default:t(()=>[s(" List of complains ")]),_:1}),(u(!0),_e(ce,null,fe(a(R),(h,ue)=>(u(),d(L,{key:ue,complain:h},null,8,["complain"]))),128))]),_:1})):N("",!0)]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(y,null,{default:t(()=>[e(r,{"prepend-icon":"mdi-file-export"},{default:t(()=>[s(" Exports ")]),_:1})]),_:1}),e(k,{class:"pa-0 ma-0"},{default:t(()=>[e(_,{class:"ma-0 pa-0"},{default:t(()=>[e(r,{subtitle:"select export format"}),e(E),e(r,{title:"Excel","prepend-icon":"mdi-file-excel",class:"mt-2",loading:"",onClick:l[2]||(l[2]=h=>re("excel"))},{append:t(()=>[a(S)?(u(),d(Ce,{key:0,indeterminate:""})):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["rail"])}}});export{St as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./complain-item.rDgyO9A6.js","./entry.tQWHpBLf.js","./entry.JkaK1PbT.css","./slot-course-store.Z83VEvRp.js","./use-fetch-header.3DHnPbz-.js","./use-logger.h09id-NO.js","./VSkeletonLoader.bS24LWfm.js","./VRow.WlLBb9Jc.js","./VRow.Jj_ITn01.css","./index.AmeJTHgO.js","./index.RLmRraAs.css","./VSkeletonLoader.ENVXDrOk.css","./VAvatar.NX62-iRj.js","./transition.31NosCAE.js","./VAvatar.Y9acgeJC.css","./VList.lljtylUW.js","./index.qvKOBlyP.js","./ssrBoot.0aXw1rzb.js","./createSimpleFunctional.413Od-xt.js","./VDivider.KeqwIEcH.js","./VDivider.8k_-HhJN.css","./VList.caQDbXay.css","./VChip.ttJWPZTa.js","./VBtn._oQ1uiNP.js","./VProgressCircular.DTBbBXDU.js","./VProgressCircular.u2v1YYMj.css","./VBtn.Y_2JgC81.css","./VChip.y9TZEtu3.css","./VTooltip.gJvVvmRp.js","./VOverlay.1V9m9YmJ.js","./easing.imumzmxr.js","./lazy.hsVx4m50.js","./VOverlay.XsbusQk2.css","./forwardRefs.y8pOSn8h.js","./VTooltip.oPNLlzwT.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}