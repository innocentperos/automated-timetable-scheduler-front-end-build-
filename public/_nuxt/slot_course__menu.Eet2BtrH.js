import{n as oe,h as P,v as D,o as n,y as _,w as e,b as t,d as a,Q as $,t as v,Z as E,c as V,a2 as se,a1 as ae,z as l,a as u,D as C,L as T,C as y,B as h,$ as Q,a0 as U}from"./entry.tQWHpBLf.js";import{u as z}from"./useSlotCourse.xKZgOLu0.js";import{u as w}from"./use-notification.Rdal1ke4.js";import{u as le}from"./useGlobalView.1_iJaLaV.js";import{d as re}from"./index.qvKOBlyP.js";import{a as d,b as x,V as L}from"./VList.lljtylUW.js";import{V as R}from"./VChip.ttJWPZTa.js";import{V as ie}from"./VDivider.KeqwIEcH.js";import{V as j}from"./VMenu.CmTKH41A.js";import{V as b}from"./index.AmeJTHgO.js";import{V as ne,b as ue}from"./VCard.T8BHTP73.js";import"./VSelect.4u-stGGs.js";import{V as k}from"./VBtn._oQ1uiNP.js";import{V as M}from"./VProgressCircular.DTBbBXDU.js";import{V as F}from"./VBadge.ClXMEkqI.js";import{V as O}from"./VAlert.9L9TAqJu.js";import{V as G}from"./VTooltip.gJvVvmRp.js";import"./use-fetch-header.3DHnPbz-.js";import"./use-logger.h09id-NO.js";import"./VRow.WlLBb9Jc.js";import"./ssrBoot.0aXw1rzb.js";import"./transition.31NosCAE.js";import"./createSimpleFunctional.413Od-xt.js";import"./VAvatar.NX62-iRj.js";import"./VOverlay.1V9m9YmJ.js";import"./easing.imumzmxr.js";import"./lazy.hsVx4m50.js";import"./forwardRefs.y8pOSn8h.js";import"./dialog-transition.OyYDh7J5.js";import"./VTextField.6LPIlZmm.js";import"./VInput.AAxW8xuy.js";import"./VCheckboxBtn.ztQGvB4X.js";const de=Q(()=>U(()=>import("./is-authenticated.2_vl-wsG.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(c=>c.default||c)),ce=Q(()=>U(()=>import("./slot_course__complains.1k8usPhu.js"),__vite__mapDeps([12,1,2,13,14,15,16,5,6,4,7,17,18,19,20,21,22,23,24,25,26,27,28,29,3,8,9,10,30,31,32,33,34,35,36,37,38,39]),import.meta.url).then(c=>c.default||c));const me=u("span",null," Are you sure you want to remove the course from this slot ",-1),pe={class:"d-flex justify-end"},fe=u("span",{class:"pl-2"},"Delete",-1),_e={class:"d-flex flex-column my-2 relative"},ge={key:0},ve={key:1},Ve={key:2},Ce={class:"d-flex justify-space-between"},ye=u("span",null,"No venue assigned",-1),he={class:"d-flex justify-space-between"},be=u("span",null,"Insufficient invigilators assigned",-1),ke={class:"pa-1"},we={class:"d-flex flex-wrap pa-1"},rt=oe({__name:"slot_course__menu",props:{slotCourse:{},timetable:{},errors:{},errorCount:{}},emits:["refresh","edit","loading"],setup(c,{emit:Z}){const i=c,N=Z;function I(){N("refresh")}const{pending:g,error:m,execute:q,reset:H}=z().assignInvigilator(i.slotCourse,I),{pending:S,execute:J,error:A}=z().assignVenueAutomatically(I);P([m],()=>{if(m.value){if(!m.value.statusCode){w().postNetowrkIssue();return}switch(m.value.statusCode){case 406:w().add({title:"Invigilator assigning failed",text:`No venues assigned to course ${i.slotCourse.course.title} (${i.slotCourse.course.code})`,closable:!0,color:"amber",icon:"mdi-alert-circle"});break;case 412:w().add({title:"Invigilator assigning failed",text:`No staff from  ${i.slotCourse.course.department.title} (${i.slotCourse.course.department.code}) is available to invigilate ${i.slotCourse.course.title} (${i.slotCourse.course.code})`,closable:!0,color:"amber",icon:"mdi-alert-circle"});break;default:w().add({title:"Invigilator assigning failed",text:"Something went wrong on the server while attempting to assign invigilator(s) to "+i.slotCourse.course.title+` (${i.slotCourse.course.code})`,closable:!0,color:"amber",icon:"mdi-alert-circle"})}}});const xe=D(()=>{const o=[];for(let r=0;r<i.timetable.days_count;r++)o.push("Day "+(r+1));return o}),Ne=D(()=>{const o=[];for(let r=0;r<i.timetable.slot_per_day;r++)o.push("Slot "+(r+1));return o}),K=D(()=>S.value||g.value),W=z(),{pending:p,execute:X}=W.deleteSlotCourse(i.slotCourse,I);P([S,g,p],()=>{N("loading",[g.value,S.value,p.value])});const{show:Y}=le().makeComplainDialog();async function ee(){Y(i.slotCourse)}return(o,r)=>{const f=de,te=ce;return n(),_(L,{class:"py-0 my-1",width:"400"},{default:e(()=>[t(d,{class:"py-2 teal bg-teal",title:o.slotCourse.course.code,subtitle:o.slotCourse.course.title},null,8,["title","subtitle"]),t(d,{class:"py-2"},{title:e(()=>[a(" Venues ")]),subtitle:e(()=>[(n(!0),V($,null,E(o.slotCourse.venues,s=>(n(),_(R,{key:s.pk,class:"mr-1"},{default:e(()=>[a(v(s.title),1)]),_:2},1024))),128))]),_:1}),t(ie),C("",!0),t(f,{"user-type":"admin"},{default:e(()=>[t(d,{onClick:r[0]||(r[0]=s=>N("edit"))},{append:e(()=>[t(b,null,{default:e(()=>[a("mdi-pencil")]),_:1})]),default:e(()=>[t(x,null,{default:e(()=>[a("Edit sourse slot")]),_:1})]),_:1})]),_:1}),t(f,{"user-type":"admin"},{default:e(()=>[t(j,{location:"left",class:"ml-2","close-on-content-click":!1},{activator:e(({props:s})=>[t(d,T(s,{disabled:l(p)}),{append:e(()=>[h(t(b,null,{default:e(()=>[a("mdi-delete")]),_:1},512),[[y,!l(p)]])]),prepend:e(()=>[h(t(M,{indeterminate:"",size:20,class:"mr-2"},null,512),[[y,l(p)]])]),default:e(()=>[t(x,null,{default:e(()=>[a(v(l(p)?"Deleting":"Delete from slot"),1)]),_:1})]),_:2},1040,["disabled"])]),default:e(()=>[t(ne,{width:400,class:"mx-2"},{default:e(()=>[t(ue,null,{default:e(()=>[me,u("div",pe,[t(k,{onClick:l(X),loading:l(p),color:"error"},{default:e(()=>[t(b,null,{default:e(()=>[a("mdi-delete")]),_:1}),fe]),_:1},8,["onClick","loading"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(f,{"user-type":["staff","student"]},{default:e(()=>[t(d,{onClick:ee},{append:e(()=>[t(b,null,{default:e(()=>[a("mdi-comment")]),_:1})]),default:e(()=>[t(x,null,{default:e(()=>[a("Report issues")]),_:1})]),_:1})]),_:1}),t(f,{"user-type":["staff","admin"]},{default:e(()=>[o.errorCount>0?(n(),_(j,{key:0,location:"right","close-on-content-click":!1,offset:10},{activator:e(({props:s})=>[t(d,ae(se(s)),{append:e(()=>[t(b,{color:"amber"},{default:e(()=>[a("mdi-alert-circle-outline")]),_:1})]),prepend:e(()=>[t(F,{location:"center center",color:"amber",content:o.errorCount},{default:e(()=>[h(t(M,{indeterminate:"",color:"amber"},null,512),[[y,l(K)]])]),_:1},8,["content"])]),default:e(()=>[t(x,{class:"text-amber"},{default:e(()=>[a("View issues")]),_:1})]),_:2},1040)]),default:e(()=>[u("div",_e,[t(re,{origin:"50%",group:""},{default:e(()=>[h(t(O,{type:"error",dismissible:""},{close:e(()=>[t(k,{color:"white",onClick:r[1]||(r[1]=s=>A.value=void 0),icon:"mdi-close"})]),default:e(()=>[a(" Error while assigning venue ")]),_:1},512),[[y,l(A)]]),h(t(O,{type:"error",class:"my-1",dismissible:"",width:400},{close:e(()=>[t(k,{color:"white",onClick:l(H),icon:"mdi-close"},null,8,["onClick"])]),default:e(()=>{var s,B;return[((s=l(m))==null?void 0:s.statusCode)==412?(n(),V("span",ge," No available staff from "+v(o.slotCourse.course.department.title)+" ("+v(o.slotCourse.course.department.code)+") department to assign ",1)):((B=l(m))==null?void 0:B.statusCode)==406?(n(),V("span",ve," No venue assigned to course ")):(n(),V("span",Ve," No available department staff to assign "))]}),_:1},512),[[y,l(m)]])]),_:1})]),t(L,{variant:"tonal",width:"400",class:"my-0 py-0"},{default:e(()=>[o.errors.venue?(n(),_(d,{key:0},{default:e(()=>[u("div",Ce,[ye,t(f,{"user-type":["admin"]},{default:e(()=>[t(G,{location:"bottom"},{activator:e(({props:s})=>[t(k,T({size:"small"},s,{loading:l(g),onClick:r[2]||(r[2]=B=>l(J)(o.slotCourse))}),{default:e(()=>[a("slove issue")]),_:2},1040,["loading"])]),default:e(()=>[a(" Assign venue automatically ")]),_:1})]),_:1})])]),_:1})):C("",!0),o.errors.invigilators?(n(),_(d,{key:1},{default:e(()=>[u("div",he,[be,t(f,{"user-type":["admin"]},{default:e(()=>[t(G,{location:"bottom"},{activator:e(({props:s})=>[t(k,T({size:"small"},s,{loading:l(g),onClick:l(q)}),{default:e(()=>[a("slove issue")]),_:2},1040,["loading","onClick"])]),default:e(()=>[a(" Assign invigilators automatically ")]),_:1})]),_:1})])]),_:1})):C("",!0),o.errors.confict?(n(),_(d,{key:2},{title:e(()=>[u("span",ke,[t(F,{class:"text-amber pl-5",location:"left center",content:o.errors.confict.length,"offset-x":-15,color:"amber"},{default:e(()=>[a("Conflict")]),_:1},8,["content"]),a(" , students on thesame day also offering ")])]),subtitle:e(()=>[u("div",we,[(n(!0),V($,null,E(o.errors.confict,s=>(n(),_(R,{key:s.pk,class:"mr-1",color:"amber"},{default:e(()=>[a(v(s.course.code),1)]),_:2},1024))),128))])]),_:1})):C("",!0)]),_:1})]),_:1})):C("",!0)]),_:1}),t(f,{"user-type":["staff","admin"]},{default:e(()=>[t(te,{"slot-course":o.slotCourse},null,8,["slot-course"])]),_:1})]),_:1})}}});export{rt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./is-authenticated.2_vl-wsG.js","./entry.tQWHpBLf.js","./entry.JkaK1PbT.css","./VBtn._oQ1uiNP.js","./index.AmeJTHgO.js","./VRow.WlLBb9Jc.js","./VRow.Jj_ITn01.css","./index.RLmRraAs.css","./VProgressCircular.DTBbBXDU.js","./VProgressCircular.u2v1YYMj.css","./VBtn.Y_2JgC81.css","./is-authenticated.MRbMt392.css","./slot_course__complains.1k8usPhu.js","./complain-store.LCm3VWOX.js","./use-fetch-header.3DHnPbz-.js","./use-logger.h09id-NO.js","./VBadge.ClXMEkqI.js","./transition.31NosCAE.js","./VBadge.RXiHNk7i.css","./VList.lljtylUW.js","./index.qvKOBlyP.js","./ssrBoot.0aXw1rzb.js","./createSimpleFunctional.413Od-xt.js","./VAvatar.NX62-iRj.js","./VAvatar.Y9acgeJC.css","./VDivider.KeqwIEcH.js","./VDivider.8k_-HhJN.css","./VList.caQDbXay.css","./VCard.T8BHTP73.js","./VCard.3-GUCx0W.css","./VExpansionPanels.Cp-9pIPO.js","./VExpansionPanels.RUZ5Akns.css","./VDialog.SCbeIy52.js","./VOverlay.1V9m9YmJ.js","./easing.imumzmxr.js","./lazy.hsVx4m50.js","./VOverlay.XsbusQk2.css","./forwardRefs.y8pOSn8h.js","./dialog-transition.OyYDh7J5.js","./VDialog.lRypuzw5.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}