import{u as x}from"./fetch.EGa3nfvI.js";import{n as N,r as d,T as v,W as S,V as w,v as R,q as U,X as A,o as E,y as L,w as a,z as s,A as V,b as e,a as h,d as n,t as T}from"./entry.tQWHpBLf.js";import{u as _}from"./use-fetch-header.3DHnPbz-.js";import{u as g}from"./use-notification.Rdal1ke4.js";import{a as B,V as $}from"./VRow.WlLBb9Jc.js";import{V as Y}from"./VDataTable.Jz7QZbN2.js";import{V as H}from"./VSpacer.t62wCS3Z.js";import{V as m}from"./VBtn._oQ1uiNP.js";import{V as z}from"./VSkeletonLoader.bS24LWfm.js";import{V as F}from"./VDialog.SCbeIy52.js";import{V as I,a as P,b as q,c as M}from"./VCard.T8BHTP73.js";import"./VSelect.4u-stGGs.js";import"./VTextField.6LPIlZmm.js";import"./index.qvKOBlyP.js";import"./transition.31NosCAE.js";import"./VInput.AAxW8xuy.js";import"./index.AmeJTHgO.js";import"./easing.imumzmxr.js";import"./forwardRefs.y8pOSn8h.js";import"./VAvatar.NX62-iRj.js";import"./VList.lljtylUW.js";import"./ssrBoot.0aXw1rzb.js";import"./createSimpleFunctional.413Od-xt.js";import"./VDivider.KeqwIEcH.js";import"./dialog-transition.OyYDh7J5.js";import"./VMenu.CmTKH41A.js";import"./VOverlay.1V9m9YmJ.js";import"./lazy.hsVx4m50.js";import"./VProgressCircular.DTBbBXDU.js";import"./VCheckboxBtn.ztQGvB4X.js";import"./VChip.ttJWPZTa.js";import"./filter.y4xAiLA_.js";const W={class:"d-flex pa-8"},X=h("span",{class:"text-h6 text-uppercase"},"Department Staff",-1),xe=N({__name:"staff-list-table",props:{departmentPk:{},active:{type:Boolean}},setup(y){const k=[{title:"Name",key:"name",value:"name"},{title:"Staff Id",key:"staff_id",value:"staff_id"},{title:"Supervisor",key:"can_supervise",value:t=>t.can_supervise?"Yes":"No"},{title:"Invigilator",key:"can_invigilate",value:t=>t.can_invigilate?"Yes":"No"}],p=y,o=d([]),{data:u,pending:C,refresh:b}=x(`/departments/${p.departmentPk}/staffs/`,{baseURL:v().public.baseURL,headers:_([]),retry:5,retryDelay:300,default(){return[]}},"$wHAh2pDCz4");let f=[];S(()=>{f=w().addActions([{title:"Delete",icon:"mdi-delete",color:"error",action(){},hidden:R(()=>U().isAdmin.value?!p.active||o.value.length<1:!0)}])}),A(()=>{f.forEach(g().remove)});const r=d(!1),c=d(!1);async function D(){if(!(o.value.length<1))try{c.value=!0,await $fetch("/stafffs/multiple_delete/",{baseURL:v().public.baseURL,method:"DELETE",body:o.value,headers:_([])}),u.value=u.value.filter(t=>!o.value.includes(t.pk)),g().add({text:`Successfully deleted ${o.value.length} courses`,icon:"mdi-delete",color:"teal",action:t=>t()}),o.value=[]}catch(t){console.log({error:t})}finally{c.value=!1,r.value=!1}}return(t,l)=>(E(),L($,null,{default:a(()=>[e(B,null,{default:a(()=>[e(Y,{headers:k,items:s(u),"show-select":"",modelValue:s(o),"onUpdate:modelValue":l[0]||(l[0]=i=>V(o)?o.value=i:null),"item-value":"pk",loading:s(C)},{top:a(()=>[h("div",W,[X,e(H),e(m,{icon:"mdi-refresh",color:"primary",onClick:s(b)},null,8,["onClick"])])]),loading:a(()=>[e(z,{type:"table-row@6"})]),_:1},8,["items","modelValue","loading"]),e(F,{modelValue:s(r),"onUpdate:modelValue":l[2]||(l[2]=i=>V(r)?r.value=i:null),"max-width":"500px",transition:"dialog-transition"},{default:a(()=>[e(I,null,{default:a(()=>[e(P,{"primary-title":"",class:"pa-4"},{default:a(()=>[n(" Are you sure? ")]),_:1}),e(q,null,{default:a(()=>[n(" You are about to delete the "+T(t.selectedCourses.length)+" selected staffs ",1)]),_:1}),e(M,{class:"pa-4"},{default:a(()=>[e(m,{onClick:D,color:"error",variant:"elevated"},{default:a(()=>[n(" Yes, delete ")]),_:1}),e(m,{class:"ml-2",onClick:l[1]||(l[1]=i=>r.value=!1)},{default:a(()=>[n("No, Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{xe as default};
